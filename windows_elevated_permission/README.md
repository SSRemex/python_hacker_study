## `bhservice.py` 服务文件 
该服务会定时将文件从`SRC`目录下将文件复制到`TGT`目录下，执行后立马删除
通过`pyinstaller -F --hiddenimport win32timezone bhservice.py`生成`bhservice.exe`可执行文件
随后win10中需要以管理员身份去启动服务 `bhservice.py install` `bhservice.py start`

## `process_monitor.py` 进程监控
通过WMI，该程序可监控进程，在进程创建时会打印进程相关信息包括权限，如果该进程是由管理员权限执行，则权限信息无法捕获，甚至使用管理员权限也依旧无法捕获。通过查阅资料发现，可以将该程序在代码中进行权限提升，提升至DEBUG权限有可能解决，但是并未找到python版本程序，自己也未尝试出来。在win10之前的系统应该不存在这个问题。


## `file_monitor.py` 文件监控
该程序通过监控目录下的文件，并在服务创建文件时，抢先将恶意代码（这里使用的是最初写的netcat）写入，随后该文件会被`bhservice`服务进行执行，由于该服务是由管理员权限执行，所以注意的恶意代码也是管理员权限执行，从而得到管理员权限
这里提一点，部分程序就是通过生成临时文件，执行，删除临时文件的方式来进行更新等其他操作，所以应该属于常见的一种手段

## 小结
该部分主要通过win32相关的代码，来展现另类的攻击方式，由此产生了一些想法

通过进程监控程序，找到有着特殊权限的进程信息，随后可以看该进程都做了那些操作，如果操作固定如文件写入后执行，则可以分析该文件的执行方式，通过条件竞争的方式写入恶意代码并让该进程执行，达到借刀杀人
